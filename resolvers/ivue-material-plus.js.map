{"version":3,"file":"ivue-material-plus.js","sources":["../src/resolvers/ivue-material-plus.ts"],"sourcesContent":["import type { ComponentResolver, ComponentInfo } from './types';\n\nexport interface resolverOptions {\n  // use commonjs lib & source css or scss for ssr\n  ssr?: boolean\n  // 是否引入style\n  importStyle?: boolean\n  // 组件名称\n  name?: string\n}\n\n// 转换为驼峰\nfunction kebabCase(key) {\n  const result = key.replace(/([A-Z])/g, ' $1').trim();\n  return result.split(' ').join('-').toLowerCase();\n}\n\n// 安装包路径\nconst pakPath = 'ivue-material-plus/dist/unplugin-vue-components';\n\n// 颜色路径\nconst basePath = 'ivue-material-plus/dist/styles/base.css';\n// 动画路径\nconst animationPath = 'ivue-material-plus/dist/styles/animation.css';\n\n// 没有样式的组件\nconst noStylesComponents = [\n  'ivue-content',\n  'ivue-carousel-item',\n  'ivue-bottom-nav-item',\n  'ivue-breadcrumb-item',\n  'ivue-checkbox-group',\n  'ivue-collapse-panel',\n  'ivue-count-down',\n  'ivue-count-up',\n  'ivue-radio-group',\n  'ivue-option',\n  'ivue-option-group',\n  'ivue-image-preview',\n  'ivue-relative-time',\n];\n\n// 使用依赖组件\nconst useDependentComponents = [\n  // ivue-table\n  {\n    name: 'ivue-table',\n    dependent: ['IvueTableColumn']\n  },\n  // ivue-tabs\n  {\n    name: 'ivue-tabs',\n    dependent: ['IvueTabItem', 'IvueTab']\n  },\n  // ivue-select\n  {\n    name: 'ivue-select',\n    dependent: ['IvueOption', 'IvueOptionGroup']\n  },\n  // ivue-steps\n  {\n    name: 'ivue-steps',\n    dependent: ['IvueStep']\n  }\n];\n\n// 设置样式文件\nfunction getSideEffects(componentsName: string, options) {\n  // 没有样式文件\n  if (!options.importStyle) {\n    return;\n  }\n\n  // 单文件引入\n  if (options.singleFile) {\n    return [\n      `${pakPath}/styles/${componentsName}.css`\n    ];\n  }\n\n  return [\n    `${pakPath}/styles/reset.css`,\n    `${pakPath}/styles/ivue-icon.css`,\n    `${basePath}`,\n    `${animationPath}`,\n    `${pakPath}/styles/${componentsName}.css`\n  ];\n}\n\n// 请求组件\nconst resolveComponent = (componentsName: string, options: resolverOptions): ComponentInfo | undefined => {\n  // 使用依赖组件\n  let useDependentComponentsData: {\n    name: string,\n    from: string\n  } | null = null;\n\n  useDependentComponents.forEach((item) => {\n    item.dependent.forEach((dependent) => {\n      // 转换为驼峰\n      const _kebabCase = kebabCase(dependent);\n\n      // 匹配输入的组件是否符合\n      if (_kebabCase === componentsName) {\n        useDependentComponentsData = {\n          name: dependent,\n          from: `${pakPath}/${options.ssr ? 'lib' : 'es'}`,\n        };\n      }\n    });\n  });\n\n  // 注册依赖的组件\n  if (useDependentComponentsData) {\n    return useDependentComponentsData;\n  }\n\n  return {\n    name: options.name,\n    from: `${pakPath}/${options.ssr ? 'lib' : 'es'}`,\n    sideEffects: getSideEffects(componentsName, options)\n  };\n};\n\n// 请求指令\nconst resolveDirective = (name: string, options: resolverOptions) => {\n  const directives = {\n    // loading\n    Loading: {\n      name: 'IvueLoading',\n      importName: 'ivue-loading',\n      styleName: 'ivue-loading',\n      importStyle: true\n    },\n    // 水波纹\n    Ripple: {\n      name: 'Ripple',\n      importName: 'ivue-ripple',\n      styleName: 'ivue-ripple',\n      importStyle: true\n    },\n    // 点击外层触发\n    ClickOutside: {\n      name: 'ClickOutside',\n      importName: 'ivue-click-outside',\n      styleName: 'ivue-click-outside',\n      importStyle: false\n    },\n    // 手指事件\n    Touch: {\n      name: 'Touch',\n      importName: 'ivue-touch',\n      styleName: 'ivue-touch',\n      importStyle: false\n    },\n    // 文本缩略\n    LineClamp: {\n      name: 'LineClamp',\n      importName: 'ivue-line-clamp',\n      styleName: 'ivue-line-clamp',\n      importStyle: true,\n      // 单文件引入\n      singleFile: true\n    },\n  };\n\n  const directive = directives[name];\n\n  if (!directive) {\n    return;\n  }\n\n  return {\n    name: directive.name,\n    from: `${pakPath}/${options.ssr ? 'lib' : 'es'}`,\n    sideEffects: getSideEffects(directive.styleName, {\n      importStyle: directive.importStyle,\n      singleFile: directive.singleFile\n    })\n  };\n};\n\nexport function IvueMaterialPlusResolver(options?: resolverOptions): ComponentResolver[] {\n\n  let optionsResolved = {\n    ssr: false,\n    ...options,\n  }\n\n  return [{\n    type: 'component',\n    resolve: (name: string) => {\n      // 是否是 ivue组件\n      if (!name.match(/^Ivue[A-Z]/)) {\n        return;\n      }\n\n      // 转换为驼峰\n      const _kebabCase = kebabCase(name);\n\n      // 没有样式组件\n      if ([...noStylesComponents].includes(_kebabCase)) {\n        return resolveComponent(_kebabCase, {\n          name,\n          importStyle: false,\n          ...optionsResolved\n        });\n      }\n\n      // 有样式组件\n      return resolveComponent(_kebabCase, {\n        name,\n        importStyle: true,\n        ...optionsResolved\n      });\n    },\n  },\n  {\n    type: 'directive',\n    resolve: (name: string) => {\n      return resolveDirective(name, optionsResolved);\n    },\n  },\n  ];\n}\n"],"names":[],"mappings":"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"}